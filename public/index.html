<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
	<link rel="stylesheet" href="themes/simplecozy.css" type="text/css" media="screen" />
	<script type="text/javascript"
        src="//ajax.googleapis.com/ajax/libs/angularjs/1.0.7/angular.min.js"></script>
	<script src="core.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>


        <title>AutoCrest</title>
    </head>
    <body ng-app="autocrest">

	<div ng-controller="ErrorController" >
        <h1>Hello {{errorTo.title}}</h1>
        </div>

    	<div>
        <h1>AutoCrest</h1>
	<h1>Tue, 26 Aug 2014 19:34:17 -0700</h1>
    	</div>

	<div ng-controller="FormController">
    	<form novalidate class="simple-form">
		<input name="address" ng-model="user.address" placeholder="Enter location/address">
		<input name="plate_number" ng-model="user.plate_number" placeholder="Enter license plate number">
		<div ng-controller="PhoneController" ><font color="red">{{error}}</font></div>
		<input name="phone_number" ng-model="user.phone_number"  placeholder="Enter phone number">
		<input name="price" ng-model="user.price"  placeholder="Enter price">
        <button onclick="sell(this.form)">Sell Parking Spot</button>
        <button onclick="buy(this.form)">Buy Parking Spot</button>
        </form>
        <pre>form = {{user | json}}</pre>
        <pre>master = {{master | json}}</pre>
        </div>
        <p>
	Looking for parking close to where you are? This spot is for you.
        </p>
        <p>
	Advertise or buy parking. Choose one. All transactions are to be negotiated between the parker and parkee. AutoCrest is not responsible for guarantee of parking spots, payment, or liability resulting from this sites use.
        </p>
    	</div>

<script src="/socket.io/socket.io.js"></script>
<script>
function PhoneController($scope){
    $scope.error='';
}

function FormController($scope){
    $scope.error='';
}

    angular.module("autocrest", [])
    .controller("ErrorController", function($scope) {
    $scope.errorTo = {};
    $scope.errorTo.title = "World, AutoCrest";
    $scope.errorTo.phone = "*";
    });

  var socket = io.connect('http://localhost');

function transact(transaction, data){ 
    socket.emit("transaction", { 
        address: data.address.value,
        phone_number: data.phone_number.value,
        price: data.price.value, 
        plate_number: data.plate_number.value,
        request: transaction 
    }); // END socket.emit
}

function buy(data){ 
    transact("buy", data);
}

function sell(data){ 
    transact("sell", data);
}

  socket.on('news', function (data) {
      console.log(data);
	  // socket.emit('my other event', { my: 'data' });
      window.stop();
  });

  socket.on('failed', function (data) {
      //io.sockets.emit('failed', { error: 'failed to validate' });
      console.log("failed");
      window.stop();
  });

/*
angular.module('formExample', [])
.controller('FormController', ['$scope', function($scope) {
$scope.master = {};

    $scope.update = function(user) {
        $scope.master = angular.copy(user);
    };

}]);
*/

</script>

</body></html>

